<!DOCTYPE HTML>
<html>
<head>
<style>
img {
    max-width: 100%;
    height: 50em;
    width: 50em;
}
div {
height: 50em;
width: 50em;
}
</style>
</head>
<body>
<link href="./cropper.css" rel="stylesheet">
<script src="./cropper.js"></script>
<script src="./dummy.js"></script>
<script>
var image = document.createElement("img");
image.setAttribute("src", "tst_raw.jpg");
var div = document.createElement("div");
document.body.appendChild(div);
div.appendChild(image);

var cropper = new Cropper(image);

function getItems(canvas) {
    var context = canvas.getContext("2d");
    var pixels = context.getImageData(0, 0, canvas.width, canvas.height);
    var d = pixels.data;
    for (var i=0; i<d.length; i+=4) {
        var r = d[i];
        var g = d[i+1];
        var b = d[i+2];
        var v = (0.2126*r + 0.7152*g + 0.0722*b >= 190) ? 255 : 0;
        pixels.data[i] = pixels.data[i+1] = pixels.data[i+2] = v;
    }
    context.putImageData(pixels, 0, 0);
    generateItemList(canvas, (output) => {
        console.log(output);
    });
}
</script>
<button onclick="getItems(cropper.getCroppedCanvas())">Crop</button>
</body>
</html>
